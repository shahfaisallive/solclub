(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(12165)}])},12165:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return T}});var s=t(85893),a=t(67294),r=t(46637),o=t(16059),c=t(45604),i=t(59917),l=t(93982);t(70999);var u=function(e){var n=e.children,t=i.clusterApiUrl("devnet"),a=[new l.O];return(0,s.jsx)(r.U,{endpoint:t,children:(0,s.jsx)(o.n,{wallets:a,autoConnect:!0,children:(0,s.jsx)(c.s,{children:n})})})},d=t(58455),h=function(){return(0,s.jsxs)("nav",{className:"navbar justify-content-between",children:[(0,s.jsx)("a",{href:"solclub.io",className:"navbar-brand",children:(0,s.jsx)("img",{src:"/solclubLogo.png",alt:"logo",className:"navlogo"})}),(0,s.jsx)("div",{children:(0,s.jsx)(d.a,{})})]})},m=t(47568),f=t(10797),x=t(10092),p=t(58467),g=t(87435),j=t(23339),k=t(54306),b=function(e){var n=e.walletTokens,t=e.stakeHandler,r=(0,a.useState)(null),o=r[0],c=r[1],i=(0,a.useState)(!1),l=i[0],u=i[1],d=(0,a.useState)(0),h=d[0],m=d[1],f=(0,a.useState)(!1),x=f[0],p=f[1];return(0,s.jsxs)("div",{className:"container",children:[(0,s.jsxs)("div",{className:"row justify-content-between",children:[(0,s.jsx)("p",{className:"heading1",children:"My Keys"}),(0,s.jsxs)("p",{className:"text1 mt-2",children:["Total Keys: ",n.length]})]}),(0,s.jsx)("div",{className:"row",children:n.map((function(e,n){return(0,s.jsx)("div",{className:"col-md-3",children:(0,s.jsxs)("div",{className:"card mb-4",children:[(0,s.jsx)("img",{className:"my-token-img",src:e.json.image,alt:"solkey nft"}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h5",{className:"heading2 text-center text-dark",children:e.name}),(0,s.jsx)("button",{className:"btn button1 text-light",onClick:function(){return n=e.address,c(n),void u(!0);var n},children:"Stake this Key"})]})]})},n)}))}),l&&(0,s.jsx)("div",{className:"modal",tabIndex:-1,role:"dialog",style:{display:"block",backgroundColor:"#000000"},children:(0,s.jsx)("div",{className:"modal-dialog",role:"document",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",children:"Confirmation"}),(0,s.jsx)("button",{type:"button",className:"close",onClick:function(){return u(!1)},children:(0,s.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,s.jsxs)("div",{className:"modal-body flex",children:[(0,s.jsx)("p",{children:"Select the Stake duration"}),(0,s.jsx)("input",{className:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"d_option1",value:7,checked:7===h,onChange:function(){return m(7)}}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"d_option1",children:"7 Days"}),(0,s.jsx)("input",{className:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"d_option2",value:14,checked:14===h,onChange:function(){return m(14)}}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"d_option2",children:"14 Days"}),(0,s.jsx)("input",{className:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"d_option3",value:28,checked:28===h,onChange:function(){return m(28)}}),(0,s.jsx)("label",{className:"form-check-label",htmlFor:"d_option3",children:"28 Days"})]}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return u(!1)},children:"Cancel"}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){null!==o&&0!==h&&(p(!0),t(o,86400*h).then((function(){u(!1),c(null),p(!1)})).catch((function(e){console.log("Stake Error:",e),u(!1),c(null)})))},disabled:!h,children:x?(0,s.jsx)("div",{className:"spinner-border spinner-border-sm text-light",role:"status"}):"Stake"})]})]})})})]})},y=function(e){var n=e.stakedTokens,t=e.unstakeHandler,r=(0,a.useState)(null),o=r[0],c=r[1],l=(0,a.useState)(!1),u=l[0],d=l[1],h=(0,a.useState)(!1),m=h[0],f=h[1],x=function(e,n){var t=e+n-Math.floor((new Date).getTime()/1e3),s=3600,a=Math.floor(t/86400),r=Math.floor(t%86400/s),o=Math.floor(t%s/60),c="";return t>0?(a>0&&(c+=a+(1===a?" day ":" days ")),r>0&&(c+=r+(1===r?" hour ":" hours ")),o>0&&(c+=o+(1===o?" min ":" mins "))):c="Lock Duration Ended",c.trim()};return(0,s.jsxs)("div",{className:"container mt-5",children:[(0,s.jsxs)("div",{className:"row justify-content-between",children:[(0,s.jsx)("p",{className:"heading1",children:"Staked Keys"}),(0,s.jsxs)("p",{className:"text1 mt-2",children:["Total Staked: ",n.length]})]}),(0,s.jsx)("div",{className:"row",children:n.map((function(e,n){return(0,s.jsx)("div",{className:"col-md-3",children:(0,s.jsxs)("div",{className:"card mb-4",children:[(0,s.jsx)("img",{className:"my-token-img",src:e.json.image,alt:"solkey nft"}),(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h5",{className:"heading2 text-center text-dark",children:e.json.name}),(0,s.jsx)("p",{className:"text1 text-center text-dark",children:x(e.stakedAt,e.stakeDuration)}),(0,s.jsxs)("p",{className:"text1 text-center text-dark",children:["Reward: ",e.rewardAmount]}),(0,s.jsx)("button",{className:"btn button1 text-light",disabled:(t=e.stakedAt,a=e.stakeDuration,console.log(t),t+a-Math.floor((new Date).getTime()/1e3)>0),onClick:function(){return n=new i.PublicKey(e.mintId),c(n),void d(!0);var n},children:"Unstake this Key"})]})]})},n);var t,a}))}),u&&(0,s.jsx)("div",{className:"modal",tabIndex:-1,role:"dialog",style:{display:"block",backgroundColor:"#000000"},children:(0,s.jsx)("div",{className:"modal-dialog",role:"document",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsx)("h5",{className:"modal-title",children:"Confirmation"}),(0,s.jsx)("button",{type:"button",className:"close",onClick:function(){return d(!1)},children:(0,s.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),(0,s.jsx)("div",{className:"modal-body flex",children:(0,s.jsx)("p",{className:"text-dark",children:"Are you sure, you want to unstake this token?"})}),(0,s.jsxs)("div",{className:"modal-footer",children:[(0,s.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:function(){return d(!1)},children:"Cancel"}),(0,s.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){null!==o&&(f(!0),t(o).then((function(){d(!1),c(null),f(!0)})).catch((function(e){console.log("Stake Error:",e),d(!1),c(null)})))},children:m?(0,s.jsx)("div",{className:"spinner-border spinner-border-sm text-light",role:"status"}):"Unstake"})]})]})})})]})},v=t(6154).Z.create({baseURL:"http://54.179.231.45:3001/api"}),N=t(50822),w=t(21267),_=function(){var e=(0,k.O)(),n=e.publicKey,t=e.signTransaction,r=e.signMessage,o=((0,k.O)(),new i.Connection("https://solana-mainnet.g.alchemy.com/v2/Dsu3oYYI0gI4R4D9LCNPQimGXXOmb6k5")),c=N.I.make(o),l=(0,a.useState)(!1),u=l[0],h=l[1],_=(0,a.useState)(null),C=_[0],S=_[1],T=(0,a.useState)(null),A=T[0],O=T[1],E=(0,a.useState)([]),K=E[0],M=E[1],Z=(0,a.useState)([]),D=Z[0],I=Z[1],P=function(){var e=(0,m.Z)((function(){var e,t;return(0,x.__generator)(this,(function(s){switch(s.label){case 0:return[4,v.get("/staking/hostAddress")];case 1:return[4,s.sent().data];case 2:return e=s.sent(),O(new i.PublicKey(e.hostAddress)),[4,o.getTokenAccountsByOwner(n,{programId:p.H_})];case 3:return s.sent().value.forEach(function(){var e=(0,m.Z)((function(e){var n,t,s;return(0,x.__generator)(this,(function(a){switch(a.label){case 0:return n=g.p0.decode(e.account.data),t=new i.PublicKey(n.mint),"1"!=n.amount.toString()?[3,2]:[4,c.nfts().findByMint({mintAddress:t})];case 1:s=a.sent(),console.log(s),"SOCL"==s.symbol&&M((function(e){return(0,f.Z)(e).concat([s])})),a.label=2;case 2:return[2]}}))}));return function(n){return e.apply(this,arguments)}}()),[4,v.get("/token/staked/".concat(n.toString()))];case 4:return t=s.sent(),console.log(t.data),t.data.stakedTokens&&t.data.stakedTokens.forEach(function(){var e=(0,m.Z)((function(e){var n,t,s;return(0,x.__generator)(this,(function(a){switch(a.label){case 0:return n=new i.PublicKey(e.mintId),[4,c.nfts().findByMint({mintAddress:n})];case 1:return t=a.sent(),(s=e).json=t.json,console.log(s),I((function(e){return(0,f.Z)(e).concat([s])})),[2]}}))}));return function(n){return e.apply(this,arguments)}}()),h(!1),[2]}}))}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,m.Z)((function(e){var n,t;return(0,x.__generator)(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),n=(new TextEncoder).encode(e),[4,r(n)];case 1:return[2,s.sent()];case 2:return t=s.sent(),console.error("Error fetching message:",t),[3,3];case 3:return[2]}}))}));return function(n){return e.apply(this,arguments)}}(),H=function(){var e=(0,m.Z)((function(e,s){var a,r,l,u,d,h,f,p,g,k,b,y;return(0,x.__generator)(this,(function(N){switch(N.label){case 0:return console.log("stake called..."),a=new i.PublicKey(n),[4,(0,j._)(o,C,e,a)];case 1:return r=N.sent(),console.log(r.address.toBase58()),[4,v.get("/staking/token-account/".concat(e.toBase58()))];case 2:l=N.sent(),console.log("hostTokenAccount: ",l.data.tokenAccount),N.label=3;case 3:return N.trys.push([3,8,,9]),d={publicKey:a,signTransaction:function(){var e=(0,m.Z)((function(e){return(0,x.__generator)(this,(function(n){return[2,e]}))}));return function(n){return e.apply(this,arguments)}}(),signMessage:function(){var e=(0,m.Z)((function(e){return(0,x.__generator)(this,(function(n){return[2,e]}))}));return function(n){return e.apply(this,arguments)}}(),signAllTransactions:function(){var e=(0,m.Z)((function(e){return(0,x.__generator)(this,(function(n){return[2,e]}))}));return function(n){return e.apply(this,arguments)}}()},c.use((0,w.t)({publicKey:a,signTransaction:function(){var e=(0,m.Z)((function(e){return(0,x.__generator)(this,(function(n){return[2,e]}))}));return function(n){return e.apply(this,arguments)}}()})),[4,c.nfts().findByMint({mintAddress:e})];case 4:return h=N.sent(),console.log(h),f=c.nfts().builders().transfer({nftOrSft:h,fromOwner:a,toOwner:A,authority:d}),[4,o.getLatestBlockhash()];case 5:return p=N.sent(),[4,t(f.toTransaction(p))];case 6:return g=N.sent(),[4,o.sendRawTransaction(g.serialize())];case 7:return u=N.sent(),console.log("stakeHash: ",u),[3,9];case 8:return k=N.sent(),console.log(k),[3,9];case 9:return u?(console.log("stake tx Completed"),b={mintId:e,txHash:u,stakeDuration:s,ownerAddress:C,ownerTokenAccount:r.address.toString(),hostTokenAccount:l.data.tokenAccount},[4,v.post("/staking/stake",b,{headers:{"Content-Type":"application/json"}})]):[3,11];case 10:return y=N.sent(),console.log(y),[3,12];case 11:console.log("transaction failed"),N.label=12;case 12:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),L=function(){var e=(0,m.Z)((function(e){var n,t,s,a,r;return(0,x.__generator)(this,(function(o){switch(o.label){case 0:return[4,v.get("/auth/message")];case 1:return n=o.sent(),t=n.data.message,console.log("authMsg: ",t),[4,B(t)];case 2:return(s=o.sent())?(a={mintId:e,authMsg:t,signatureUint8Array:s,walletAddress:C},[4,v.post("/staking/unstake",a,{headers:{"Content-Type":"application/json"}})]):[3,4];case 3:return r=o.sent(),console.log(r),[3,5];case 4:console.log("Unable to sign the message"),o.label=5;case 5:return[2]}}))}));return function(n){return e.apply(this,arguments)}}();return(0,a.useEffect)((function(){h(!0),n?(S(n.toBase58()),P()):h(!1)}),[n]),(0,s.jsx)("div",{className:"container",children:C?u&&C?(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,s.jsx)("span",{className:"sr-only",children:"Loading..."})})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{walletTokens:K,stakeHandler:H}),(0,s.jsx)(y,{stakedTokens:D,unstakeHandler:L})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"heading1 text-center",children:"Please Connect your Phantom wallet"}),(0,s.jsx)("div",{className:"d-flex justify-content-center",children:(0,s.jsx)(d.a,{})})]})})},C=t(9008),S=t.n(C),T=function(){return(0,s.jsxs)("div",{children:[(0,s.jsxs)(S(),{children:[(0,s.jsx)("title",{children:"Solclub Staking"}),(0,s.jsx)("link",{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"})]}),(0,s.jsxs)(u,{children:[(0,s.jsx)(h,{}),(0,s.jsx)("div",{className:"pt-5",children:(0,s.jsx)(_,{})})]})]})}},7420:function(){},95856:function(){},46601:function(){}},function(e){e.O(0,[766,140,710,774,888,179],(function(){return n=48312,e(e.s=n);var n}));var n=e.O();_N_E=n}]);